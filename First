<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClearKey DRM Demo</title>
    <script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
</head>
<body>
    <h1>ClearKey Encrypted Video Demo</h1>
    <video id="videoPlayer" controls></video>

    <script>
        var player = dashjs.MediaPlayer().create();
        player.initialize(document.querySelector("#videoPlayer"), "encrypted_video.mpd", true);
        
        player.on('encrypted', function(e) {
            const key = {
                keyId: '0123456789abcdef0123456789abcdef',  // Key ID from XML file
                key: 'MTIzNDU2Nzg5YWJjZGVmZzEyMzQ1Njc4'    // Base64-encoded decryption key
            };

            const json = {
                keys: [{
                    kty: 'oct',      // Key type
                    alg: 'A128KW',   // Algorithm
                    kid: key.keyId,  // Key ID (from the MPD)
                    k: key.key       // Actual key (base64 encoded)
                }]
            };

            e.target.addEventListener('message', function(message) {
                message.target.update(JSON.stringify(json));
            });
        });
    </script>
</body>
</html>
